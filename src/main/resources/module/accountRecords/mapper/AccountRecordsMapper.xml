<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hehanpeng.ssm.module.accountRecods.mapper.AccountRecordsMapper">
    <resultMap id="BaseResultMap" type="com.hehanpeng.ssm.module.accountRecods.pojo.AccountRecords">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        <id column="ar_id" jdbcType="VARCHAR" property="arId"/>
        <result column="sup_id" jdbcType="INTEGER" property="supId"/>
        <result column="ar_date" jdbcType="DATE" property="arDate"/>
        <result column="ar_order_id" jdbcType="VARCHAR" property="arOrderId"/>
        <result column="ar_bus_type" jdbcType="VARCHAR" property="arBusType"/>
        <result column="ar_payable" jdbcType="DECIMAL" property="arPayable"/>
        <result column="ar_paid" jdbcType="DECIMAL" property="arPaid"/>
        <result column="ar_arrears" jdbcType="DECIMAL" property="arArrears"/>
        <result column="ar_discount" jdbcType="DECIMAL" property="arDiscount"/>
        <result column="ar_attn" jdbcType="VARCHAR" property="arAttn"/>
        <result column="ar_operator" jdbcType="INTEGER" property="arOperator"/>
        <result column="ar_remark" jdbcType="VARCHAR" property="arRemark"/>
    </resultMap>
    <sql id="Base_Column_List">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        ar_id, sup_id, ar_date, ar_order_id, ar_bus_type, ar_payable, ar_paid, ar_arrears,
        ar_discount, ar_attn, ar_operator, ar_remark
    </sql>
    <select id="selectByPrimaryKey" parameterType="java.lang.String" resultMap="BaseResultMap">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        select
        <include refid="Base_Column_List"/>
        from account_records
        where ar_id = #{arId,jdbcType=VARCHAR}
    </select>
    <delete id="deleteByPrimaryKey" parameterType="java.lang.String">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        delete from account_records
        where ar_id = #{arId,jdbcType=VARCHAR}
    </delete>
    <insert id="insert" parameterType="com.hehanpeng.ssm.module.accountRecods.pojo.AccountRecords">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        insert into account_records (ar_id, sup_id, ar_date,
        ar_order_id, ar_bus_type, ar_payable,
        ar_paid, ar_arrears, ar_discount,
        ar_attn, ar_operator, ar_remark
        )
        values (#{arId,jdbcType=VARCHAR}, #{supId,jdbcType=INTEGER}, #{arDate,jdbcType=DATE},
        #{arOrderId,jdbcType=VARCHAR}, #{arBusType,jdbcType=VARCHAR}, #{arPayable,jdbcType=DECIMAL},
        #{arPaid,jdbcType=DECIMAL}, #{arArrears,jdbcType=DECIMAL}, #{arDiscount,jdbcType=DECIMAL},
        #{arAttn,jdbcType=VARCHAR}, #{arOperator,jdbcType=INTEGER}, #{arRemark,jdbcType=VARCHAR}
        )
    </insert>
    <insert id="insertSelective" parameterType="com.hehanpeng.ssm.module.accountRecods.pojo.AccountRecords">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        insert into account_records
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="arId != null">
                ar_id,
            </if>
            <if test="supId != null">
                sup_id,
            </if>
            <if test="arDate != null">
                ar_date,
            </if>
            <if test="arOrderId != null">
                ar_order_id,
            </if>
            <if test="arBusType != null">
                ar_bus_type,
            </if>
            <if test="arPayable != null">
                ar_payable,
            </if>
            <if test="arPaid != null">
                ar_paid,
            </if>
            <if test="arArrears != null">
                ar_arrears,
            </if>
            <if test="arDiscount != null">
                ar_discount,
            </if>
            <if test="arAttn != null">
                ar_attn,
            </if>
            <if test="arOperator != null">
                ar_operator,
            </if>
            <if test="arRemark != null">
                ar_remark,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="arId != null">
                #{arId,jdbcType=VARCHAR},
            </if>
            <if test="supId != null">
                #{supId,jdbcType=INTEGER},
            </if>
            <if test="arDate != null">
                #{arDate,jdbcType=DATE},
            </if>
            <if test="arOrderId != null">
                #{arOrderId,jdbcType=VARCHAR},
            </if>
            <if test="arBusType != null">
                #{arBusType,jdbcType=VARCHAR},
            </if>
            <if test="arPayable != null">
                #{arPayable,jdbcType=DECIMAL},
            </if>
            <if test="arPaid != null">
                #{arPaid,jdbcType=DECIMAL},
            </if>
            <if test="arArrears != null">
                #{arArrears,jdbcType=DECIMAL},
            </if>
            <if test="arDiscount != null">
                #{arDiscount,jdbcType=DECIMAL},
            </if>
            <if test="arAttn != null">
                #{arAttn,jdbcType=VARCHAR},
            </if>
            <if test="arOperator != null">
                #{arOperator,jdbcType=INTEGER},
            </if>
            <if test="arRemark != null">
                #{arRemark,jdbcType=VARCHAR},
            </if>
        </trim>
    </insert>
    <update id="updateByPrimaryKeySelective" parameterType="com.hehanpeng.ssm.module.accountRecods.pojo.AccountRecords">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        update account_records
        <set>
            <if test="supId != null">
                sup_id = #{supId,jdbcType=INTEGER},
            </if>
            <if test="arDate != null">
                ar_date = #{arDate,jdbcType=DATE},
            </if>
            <if test="arOrderId != null">
                ar_order_id = #{arOrderId,jdbcType=VARCHAR},
            </if>
            <if test="arBusType != null">
                ar_bus_type = #{arBusType,jdbcType=VARCHAR},
            </if>
            <if test="arPayable != null">
                ar_payable = #{arPayable,jdbcType=DECIMAL},
            </if>
            <if test="arPaid != null">
                ar_paid = #{arPaid,jdbcType=DECIMAL},
            </if>
            <if test="arArrears != null">
                ar_arrears = #{arArrears,jdbcType=DECIMAL},
            </if>
            <if test="arDiscount != null">
                ar_discount = #{arDiscount,jdbcType=DECIMAL},
            </if>
            <if test="arAttn != null">
                ar_attn = #{arAttn,jdbcType=VARCHAR},
            </if>
            <if test="arOperator != null">
                ar_operator = #{arOperator,jdbcType=INTEGER},
            </if>
            <if test="arRemark != null">
                ar_remark = #{arRemark,jdbcType=VARCHAR},
            </if>
        </set>
        where ar_id = #{arId,jdbcType=VARCHAR}
    </update>
    <update id="updateByPrimaryKey" parameterType="com.hehanpeng.ssm.module.accountRecods.pojo.AccountRecords">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        update account_records
        set sup_id = #{supId,jdbcType=INTEGER},
        ar_date = #{arDate,jdbcType=DATE},
        ar_order_id = #{arOrderId,jdbcType=VARCHAR},
        ar_bus_type = #{arBusType,jdbcType=VARCHAR},
        ar_payable = #{arPayable,jdbcType=DECIMAL},
        ar_paid = #{arPaid,jdbcType=DECIMAL},
        ar_arrears = #{arArrears,jdbcType=DECIMAL},
        ar_discount = #{arDiscount,jdbcType=DECIMAL},
        ar_attn = #{arAttn,jdbcType=VARCHAR},
        ar_operator = #{arOperator,jdbcType=INTEGER},
        ar_remark = #{arRemark,jdbcType=VARCHAR}
        where ar_id = #{arId,jdbcType=VARCHAR}
    </update>

    <!--统计时间段内供应商采购金额-->
    <select id="selectSupplierPayable" parameterType="map" resultType="map">
    <![CDATA[



        select sum(ar_payable) total,sup_name from account_records inner join
        supplier on account_records.sup_id=supplier.sup_id
        where ar_date >=#{start} and ar_date <=#{end} and ar_bus_type='bj' group by
        account_records.sup_id,sup_name



        ]]>
  </select>
</mapper>